<head>
  <style>#map { float: right; width: 160px; height: 160px; margin: 15px 15px 15px 0px; }</style>
</head>

<body>
  <section class="page">

    <div id="profile_header" class="group">
       <%= image_tag @user.photo.url(:big) %>

       <article id="profile_header_info">
         <% unless @user == current_user %>
         <div class="matchbox group">
           <ul>
             <li class="match_percentage"><%= match(@user)[:match] %>% Match</li>
             <li class="friend_percentage"><%= match(@user)[:friend] %>% Friend</li>
             <li>67% Enemy</li>
           </ul>
         </div>

         <% end %>
         <div class="name_and_attributes">
           <ul>
             <li id="username"><%= @user.name %></li>
             <li><%= @user.age %> / <%= @user.gender %> /
               <%= @user.orientation %></li>

               <!-- Add miles away -->
             <li id="address"></li>
           </ul>

         </div>
       </article>
       <div id='map'></div>
     </div>

     <article id="details" class="group">
        <%= render "details/show", detail: @user.detail %>
        <% if my_page? %>
          <%= link_to "Edit details", edit_detail_url(@user) %>
        <% end %>
     </article>

     <article id="profile">
        <%= render "profiles/show", profile: @user.profile %>
     </article>

    <article id="questions">
     <%= render "responses/index" %>
     <p><%= link_to "Submit a question", new_question_url %></p>
     <% unless my_page? %>
       <p><%= link_to "Message me!", new_user_message_url(@user) %></p>
     <% end%>
   </article>
   </section>
</body>

<script>
  var map = L.mapbox.map('map', 'baghutch.gjcpnfje').setView([<%= @user.latitude %>, <%= @user.longitude %>], 15);
  L.mapbox.markerLayer({
      type: 'Feature',
      geometry: {
          type: 'Point',
          coordinates: [<%= @user.longitude %>, <%= @user.latitude %>]
      },
      properties: {
          'marker-color': '#F70F39',
          'marker-symbol': 'school',
          title: '<%= @user.address %>',
          description: '<%= @user.name %> is right here, right now.'
      }
  }).addTo(map);
</script>